{% extends 'base.html' %}

{% block title %}
  Маршруты для «{{ destination.name or 'Неизвестующее направление' }}»
{% endblock %}

{% block extra_css %}
<link href="{{ url_for('static', path='css/pages/trip_routes.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="glow-text">
      <i class="bi bi-signpost-split me-2"></i>
      Маршруты для «{{ destination.name }}»
    </h1>
    <a href="/pages/routes/create?trip_id={{ trip.id }}" class="btn btn-success auth-required">
      <i class="bi bi-plus-circle me-1"></i>Создать маршрут
    </a>
  </div>

  {% if routes %}
    <div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4">
      {% for route in routes %}
        <div class="col">
          <div class="card bg-secondary-dark text-light h-100 position-relative">
            {% if route.published %}
              <span class="badge bg-accent position-absolute top-0 end-0 m-2">
                <i class="bi bi-check-circle-fill me-1"></i>Опубликован
              </span>
            {% endif %}
            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ route.name }}</h5>
              <p class="card-text mb-1">
                Бюджет: <strong>{{ route.total_budget or '—' }}</strong>
              </p>
              <p class="card-text mb-3">
                Точек: <strong>{{ route.attractions|length }}</strong>
              </p>
              <div class="mt-auto d-flex gap-2">
                <a href="/pages/routes/{{ route.id }}"
                   class="btn btn-accent btn-sm flex-grow-1">
                  <i class="bi bi-eye-fill me-1"></i>Просмотреть
                </a>
                <a href="/pages/routes/{{ route.id }}/edit"
                   class="btn btn-outline-accent btn-sm auth-required">
                  <i class="bi bi-pencil-fill me-1"></i>Редактировать
                </a>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info text-center">
      У этой поездки ещё нет маршрутов. 
      <a href="/pages/routes/create?trip_id={{ trip.id }}" class="alert-link">Создать первый маршрут</a>.
    </div>
  {% endif %}
</div>
{% endblock %}
